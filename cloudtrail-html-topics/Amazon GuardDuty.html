<!DOCTYPE html>
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <title>
   Logging Amazon GuardDuty API calls with AWS CloudTrail - Amazon GuardDuty
  </title>
  <meta content="width=device-width,initial-scale=1" name="viewport"/>
  <meta content="/assets" name="assets_root"/>
  <meta content="logging-using-cloudtrail" name="target_state"/>
  <meta content="logging-using-cloudtrail" name="default_state"/>
  <link href="/assets/images/favicon.ico" rel="icon" type="image/ico"/>
  <link href="/assets/images/favicon.ico" rel="shortcut icon" type="image/ico"/>
  <link href="https://docs.aws.amazon.com/guardduty/latest/ug/logging-using-cloudtrail.html" rel="canonical"/>
  <meta content="Amazon GuardDuty is integrated with AWS CloudTrail, a service that provides a record of actions taken by a user, role, or an AWS service in GuardDuty. CloudTrail captures all API calls for GuardDuty as events, including calls from the GuardDuty console and from code calls to the GuardDuty APIs. If you create a trail, you can enable continuous delivery of CloudTrail events to an Amazon Simple Storage Service (Amazon S3) bucket, including events for GuardDuty. If you don't configure a trail, you can still view the most recent events in the CloudTrail console in" name="description"/>
  <meta content="IAD" name="deployment_region"/>
  <meta content="Amazon GuardDuty" name="product"/>
  <meta content="Amazon GuardDuty User Guide" name="guide"/>
  <meta content="Use Amazon GuardDuty to continuously monitor the security of your AWS environment." name="abstract"/>
  <meta content="en_us" name="guide-locale"/>
  <meta content="toc-contents.json" name="tocs"/>
  <link href="https://docs.aws.amazon.com/guardduty/latest/ug/logging-using-cloudtrail.html" rel="canonical"/>
  <link href="https://docs.aws.amazon.com/id_id/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="id-id" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/id_id/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="id" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/de_de/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="de-de" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/de_de/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="de" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="en-us" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="en" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/es_es/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="es-es" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/es_es/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="es" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/fr_fr/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="fr-fr" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/fr_fr/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="fr" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/it_it/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="it-it" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/it_it/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="it" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="ja-jp" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="ja" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/ko_kr/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="ko-kr" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/ko_kr/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="ko" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/pt_br/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="pt-br" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/pt_br/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="pt" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/zh_cn/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="zh-cn" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/zh_tw/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="zh-tw" rel="alternative"/>
  <link href="https://docs.aws.amazon.com/guardduty/latest/ug/logging-using-cloudtrail.html" hreflang="x-default" rel="alternative"/>
  <meta content="GuardDuty" name="feedback-item"/>
  <meta content="Amazon GuardDuty" name="this_doc_product"/>
  <meta content="Amazon GuardDuty User Guide" name="this_doc_guide"/>
  <script defer="" src="/assets/r/vendor4.js?version=2021.12.02">
  </script>
  <script defer="" src="/assets/r/vendor3.js?version=2021.12.02">
  </script>
  <script defer="" src="/assets/r/vendor1.js?version=2021.12.02">
  </script>
  <script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02">
  </script>
  <script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02">
  </script>
  <link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet"/>
  <link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet"/>
  <link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet"/>
  <script async="" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'guardduty'}" id="awsc-panorama-bundle" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" type="text/javascript">
  </script>
  <meta id="panorama-serviceSubSection" value="Amazon GuardDuty User Guide"/>
  <meta id="panorama-serviceConsolePage" value="Logging Amazon GuardDuty API calls with AWS CloudTrail"/>
 </head>
 <body class="awsdocs awsui">
  <div class="awsdocs-container">
   <awsdocs-header>
   </awsdocs-header>
   <awsui-app-layout class="awsui-util-no-gutters" header-selector="awsdocs-header" id="app-layout" navigation-change="$ctrl.onNavChange($event)" navigation-hide="false" navigation-open="$ctrl.navOpen" navigation-width="$ctrl.navWidth" ng-controller="ContentController as $ctrl" tools-change="$ctrl.onToolsChange($event)" tools-hide="$ctrl.hideTools" tools-open="$ctrl.toolsOpen" tools-width="$ctrl.toolsWidth">
    <div dom-region="navigation" id="guide-toc">
     <awsdocs-toc>
     </awsdocs-toc>
    </div>
    <div dom-region="content" id="main-column" tabindex="-1">
     <awsdocs-view class="awsdocs-view">
      <div id="awsdocs-content">
       <head>
        <title>
         Logging Amazon GuardDuty API calls with AWS CloudTrail - Amazon GuardDuty
        </title>
        <meta content="/pdfs/guardduty/latest/ug/guardduty-ug.pdf#logging-using-cloudtrail" name="pdf"/>
        <meta content="amazon-guardduty-doc-history.rss" name="rss"/>
        <meta content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=GuardDuty&amp;topic_url=https://docs.aws.amazon.com/en_us/guardduty/latest/ug/logging-using-cloudtrail.html" name="feedback"/>
        <meta content="feedbackyes.html?topic_url=https://docs.aws.amazon.com/en_us/guardduty/latest/ug/logging-using-cloudtrail.html" name="feedback-yes"/>
        <meta content="feedbackno.html?topic_url=https://docs.aws.amazon.com/en_us/guardduty/latest/ug/logging-using-cloudtrail.html" name="feedback-no"/>
        <meta content="GuardDuty,Amazon GuardDuty,GuardDuty data source,GuardDuty finding types,GuardDuty protection" name="keywords"/>
        <script type="application/ld+json">
         {
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon GuardDuty",
        "item" : "https://docs.aws.amazon.com/guardduty/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Amazon GuardDuty User Guide",
        "item" : "https://docs.aws.amazon.com/guardduty/latest/ug"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Security in Amazon GuardDuty",
        "item" : "https://docs.aws.amazon.com/guardduty/latest/ug/security.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Logging Amazon GuardDuty API calls with AWS CloudTrail",
        "item" : "https://docs.aws.amazon.com/guardduty/latest/ug/security.html"
      }
    ]
}
        </script>
       </head>
       <body>
        <div id="main">
         <div style="display: none">
          <a href="/pdfs/guardduty/latest/ug/guardduty-ug.pdf#logging-using-cloudtrail" rel="noopener noreferrer" target="_blank" title="Open PDF">
          </a>
         </div>
         <div class="breadcrumb" id="breadcrumbs">
          <a href="https://aws.amazon.com">
           AWS
          </a>
          <a href="/index.html">
           Documentation
          </a>
          <a href="/guardduty/index.html">
           Amazon GuardDuty
          </a>
          <a href="what-is-guardduty.html">
           Amazon GuardDuty User Guide
          </a>
         </div>
         <div id="page-toc-src">
          <a href="#service-name-info-in-cloudtrail">
           GuardDuty information in CloudTrail
          </a>
          <a href="#guardduty-control-plane-events-in-cloudtrail">
           GuardDuty control plane events in CloudTrail
          </a>
          <a href="#guardduty-data-events-in-cloudtrail">
           GuardDuty data events in CloudTrail
          </a>
         </div>
         <div class="awsui-util-container" id="main-content">
          <div id="main-col-body">
           <awsdocs-language-banner data-service="$ctrl.pageService">
           </awsdocs-language-banner>
           <h1 class="topictitle" id="logging-using-cloudtrail">
            Logging Amazon GuardDuty API calls with AWS CloudTrail
           </h1>
           <div class="awsdocs-page-header-container">
            <awsdocs-page-header>
            </awsdocs-page-header>
            <awsdocs-filter-selector id="awsdocs-filter-selector">
            </awsdocs-filter-selector>
           </div>
           <p>
            Amazon GuardDuty is integrated with AWS CloudTrail, a service that provides a record of actions taken
        by a user, role, or an AWS service in GuardDuty. CloudTrail captures all API calls for GuardDuty as events,
        including calls from the GuardDuty console and from code calls to the GuardDuty APIs. If you create
        a trail, you can enable continuous delivery of CloudTrail events to an Amazon Simple Storage Service (Amazon S3) bucket, including
        events for GuardDuty. If you don't configure a trail, you can still view the most recent events
        in the CloudTrail console in
            <b>
             Event history
            </b>
            . Using the information collected
        by CloudTrail, you can determine the request that was made to GuardDuty, the IP address the request
        was made from, who made the request, when it was made, and additional details.
           </p>
           <p>
            For more information about CloudTrail, including how to configure and enable it, see the
            <em>
             <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/">
              AWS CloudTrail User Guide
             </a>
            </em>
            .
           </p>
           <h2 id="service-name-info-in-cloudtrail">
            GuardDuty information in CloudTrail
           </h2>
           <p>
            CloudTrail is enabled on your AWS account when you create the account. When supported
            event activity occurs in GuardDuty, that activity is recorded in a CloudTrail event along with
            other AWS service events in
            <b>
             Event history
            </b>
            . You can view, search,
            and download recent events in your AWS account. For more information, see
            <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/view-cloudtrail-events.html">
             Viewing events with CloudTrail event
                history
            </a>
            .
           </p>
           <p>
            For an ongoing record of events in your AWS account, including events for GuardDuty,
            create a trail. A trail enables CloudTrail to deliver log files to an Amazon S3 bucket. By default,
            when you create a trail in the console, the trail applies to all Regions. The trail logs
            events from all Regions in the AWS partition and delivers the log files to the Amazon S3
            bucket that you specify. Additionally, you can configure other AWS services to further
            analyze and act upon the event data collected in CloudTrail logs. For more information, see:
           </p>
           <div class="itemizedlist">
            <ul class="itemizedlist">
             <li class="listitem">
              <p>
               <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-create-and-update-a-trail.html">
                Overview
                        for creating a trail
               </a>
              </p>
             </li>
             <li class="listitem">
              <p>
               <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-aws-service-specific-topics.html">
                CloudTrail
                        supported services and integrations
               </a>
              </p>
             </li>
             <li class="listitem">
              <p>
               <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/getting_notifications_top_level.html">
                Configuring
                        Amazon SNS notifications for CloudTrail
               </a>
              </p>
             </li>
             <li class="listitem">
              <p>
               <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html">
                Receiving CloudTrail log files from multiple regions
               </a>
               and
               <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-receive-logs-from-multiple-accounts.html">
                Receiving CloudTrail log files from multiple accounts
               </a>
              </p>
             </li>
            </ul>
           </div>
           <p>
            Every event or log entry contains information about who generated the request. The
            identity information helps you determine the following:
           </p>
           <div class="itemizedlist">
            <ul class="itemizedlist">
             <li class="listitem">
              <p>
               Whether the request was made with root user or IAM user's sign-in credentials
              </p>
             </li>
             <li class="listitem">
              <p>
               Whether the request was made with temporary security credentials for a role or
                    federated user
              </p>
             </li>
             <li class="listitem">
              <p>
               Whether the request was made by another AWS service
              </p>
             </li>
            </ul>
           </div>
           <p>
            For more information, see
            <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-user-identity.html">
             CloudTrail userIdentity
                element
            </a>
            .
           </p>
           <h2 id="guardduty-control-plane-events-in-cloudtrail">
            GuardDuty control plane events in CloudTrail
           </h2>
           <p>
            By default, CloudTrail logs all the GuardDuty API operations provided in the
            <a href="https://docs.aws.amazon.com/guardduty/latest/APIReference/">
             Amazon GuardDuty API Reference
            </a>
            as events in CloudTrail 
                files.
           </p>
           <h2 id="guardduty-data-events-in-cloudtrail">
            GuardDuty data events in CloudTrail
           </h2>
           <p>
            <a href="./runtime-monitoring.html">
             Runtime Monitoring in GuardDuty
            </a>
            uses a GuardDuty security agent 
             deployed to your Amazon Elastic Kubernetes Service (Amazon EKS) clusters, Amazon Elastic Compute Cloud (Amazon EC2) instances, 
             and AWS Fargate (Amazon Elastic Container Service (Amazon ECS) only) tasks to collect 
             add-on (
            <code class="code">
             aws-guardduty-agent
            </code>
            ) that collects
            <a href="./runtime-monitoring-collected-events.html">
             Collected runtime event types
            </a>
            for your AWS 
             workloads and then send them to GuardDuty for 
             threat detection and analysis.
           </p>
           <h3 id="runtime-monitoring-add-on-cloudtrail-logs">
            Logging and monitoring data events
           </h3>
           <p>
            You can optionally configure the AWS CloudTrail logs to view the data events for your GuardDuty security agent.
           </p>
           <p>
            To create and configure CloudTrail, see
            <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/logging-data-events-with-cloudtrail.html#logging-data-events">
             Data events
            </a>
            in the
            <em>
             AWS CloudTrail User Guide
            </em>
            and follow the instructions for
            <b>
             Logging data events with advanced event selectors in the AWS Management Console
            </b>
            . 
                While logging the trail, ensure to make the following
                changes:
           </p>
           <div class="itemizedlist">
            <ul class="itemizedlist">
             <li class="listitem">
              <p>
               For the
               <b>
                Data event type
               </b>
               , choose
               <b>
                GuardDuty 
                    detector
               </b>
               .
              </p>
             </li>
             <li class="listitem">
              <p>
               For the
               <b>
                Log selector template
               </b>
               , choose
               <b>
                Log 
                    all events
               </b>
               .
              </p>
             </li>
             <li class="listitem">
              <p>
               Expand the
               <b>
                JSON view
               </b>
               for the configuration. It should be similar 
                    to the following JSON:
              </p>
              <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><!--DEBUG: cli;bash ()--><code class="">[
  <span>{</span>
    "name": "",
    "fieldSelectors": [
      <span>{</span>
        "field": "eventCategory",
        "equals": [
          "Data"
        ]
      },
      <span>{</span>
        "field": "resources.type",
        "equals": [
          "AWS::GuardDuty::Detector"
        ]
      }
    ]
  }
]</code></pre>
             </li>
            </ul>
           </div>
           <p>
            After you enable the selector for the trail, navigate to the Amazon S3 console at
            <a href="https://console.aws.amazon.com/s3/" rel="noopener noreferrer" target="_blank">
             <span>
              https://console.aws.amazon.com/s3/
             </span>
             <awsui-icon class="awsdocs-link-icon" name="external">
             </awsui-icon>
            </a>
            . 
                You can download the data events from your S3 bucket chosen at the time of configuring the CloudTrail logs.
           </p>
           <awsdocs-copyright class="copyright-print">
           </awsdocs-copyright>
           <awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}">
           </awsdocs-thumb-feedback>
          </div>
          <noscript>
           <div>
            <div>
             <div>
              <div id="js_error_message">
               <p>
                <img alt="Warning" src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png"/>
                <strong>
                 Javascript is disabled or is unavailable in your browser.
                </strong>
               </p>
               <p>
                To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.
               </p>
              </div>
             </div>
            </div>
           </div>
          </noscript>
          <div class="awsui-util-font-size-0" id="main-col-footer">
           <div id="doc-conventions">
            <a href="/general/latest/gr/docconventions.html" target="_top">
             Document Conventions
            </a>
           </div>
           <div class="prev-next">
            <div accesskey="p" class="prev-link" href="./guardduty-opting-out-using-data.html" id="previous">
             Opting out of using your data for service improvement
            </div>
            <div accesskey="n" class="next-link" href="./understanding-guardduty-entries.html" id="next">
             Example: GuardDuty log file
                entries
            </div>
           </div>
          </div>
          <awsdocs-page-utilities>
          </awsdocs-page-utilities>
         </div>
         <div id="quick-feedback-yes" style="display: none;">
          <div class="title">
           Did this page help you? - Yes
          </div>
          <div class="content">
           <p>
            Thanks for letting us know we're doing a good job!
           </p>
           <p>
            If you've got a moment, please tell us what we did right so we can do more of it.
           </p>
           <p>
            <awsui-button click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=GuardDuty&amp;topic_url=https://docs.aws.amazon.com/en_us/guardduty/latest/ug/logging-using-cloudtrail.html" id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback">
            </awsui-button>
           </p>
          </div>
         </div>
         <div id="quick-feedback-no" style="display: none;">
          <div class="title">
           Did this page help you? - No
          </div>
          <div class="content">
           <p>
            Thanks for letting us know this page needs work. We're sorry we let you down.
           </p>
           <p>
            If you've got a moment, please tell us how we can make the documentation better.
           </p>
           <p>
            <awsui-button click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=GuardDuty&amp;topic_url=https://docs.aws.amazon.com/en_us/guardduty/latest/ug/logging-using-cloudtrail.html" id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback">
            </awsui-button>
           </p>
          </div>
         </div>
        </div>
       </body>
      </div>
     </awsdocs-view>
     <div class="page-loading-indicator" id="page-loading-indicator">
      <awsui-spinner size="large">
      </awsui-spinner>
     </div>
    </div>
    <div dom-region="tools" id="tools-panel">
     <awsdocs-tools-panel id="awsdocs-tools-panel">
     </awsdocs-tools-panel>
    </div>
   </awsui-app-layout>
   <awsdocs-cookie-banner class="doc-cookie-banner">
   </awsdocs-cookie-banner>
  </div>
 </body>
</html>
